{
    "collab_server" : "",
    "contents" : "#Working code for WGDosage MPG plots\n#Ryan Collins\n#Talkowski Lab\n#Fall 2016\n\n#Load libraries\nrequire(WGDR)\nlibrary(RColorBrewer)\nlibrary(plotrix)\n\n#Set params\noptions(scipen=1000)\nWRKDIR <- \"/Users/collins/Desktop/RCollins/Talkowski_Local/NGS/Methods/WGS_Dosage_Anomalies/WGDosage_Analysis_Fall2016/MPG_plots/\"\n\n#####Plot of SFARI+ and SFARI-\nSFARIplus <- WGD.matrix.tranche(WGD.matrix.read(paste(WRKDIR,\"../test/SFARIplus.1.normCov.10kb.matrix.bed.gz\",sep=\"\")),tranche=0.98)\nSFARIminus <- WGD.matrix.tranche(WGD.matrix.read(paste(WRKDIR,\"../test/SFARIminus.1.normCov.10kb.matrix.bed.gz\",sep=\"\")),tranche=0.98)\n#All libraries are black\ntiff(paste(WRKDIR,\"SFARI_uniform.chr1.tiff\"),width=1500,height=675,pointsize=18)\npar(mar=c(3.1,4.1,1.1,1.1))\nplot(c(0,max(SFARIplus$mat$end)),c(-0.30,0.30),type=\"n\",xaxs=\"i\",yaxs=\"i\",\n     ylab=\"Normalized Coverage Bias\",xlab=\"\",yaxt=\"n\",xaxt=\"n\")\naxis(2,at=seq(-.30,.30,0.1),labels=paste(seq(-30,30,10),\"%\",sep=\"\"),las=2)\nabline(h=seq(-0.95,0.95,by=0.1),col=\"gray75\",lty=2)\nabline(h=seq(-1,1,by=0.1),col=\"gray70\")\nabline(h=0,col=\"black\",lwd=3)\naxis(1,at=seq(0,300000000,by=25000000),labels=NA)\naxis(1,at=seq(0,300000000,by=25000000),labels=paste(seq(0,300,25),\"Mb\",sep=\"\"),tick=F,line=-0.6)\nmtext(1,text=\"Coordinate (chr1; GRCh37)\",line=1.5)\napply(SFARIplus$res[,4:ncol(SFARIplus$res)],2,function(vals){\n  points(smooth.spline(SFARIplus$mat$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(\"black\",alpha=0.1))\n})\napply(SFARIminus$res[,4:ncol(SFARIminus$res)],2,function(vals){\n  points(smooth.spline(SFARIminus$mat$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(\"black\",alpha=0.1))\n})\ndev.off()\n#Libraries colored by batch\ntiff(paste(WRKDIR,\"SFARI_batched.chr1.tiff\"),width=1500,height=675,pointsize=18)\npar(mar=c(3.1,4.1,1.1,1.1))\nplot(c(0,max(SFARIplus$mat$end)),c(-0.30,0.30),type=\"n\",xaxs=\"i\",yaxs=\"i\",\n     ylab=\"Normalized Coverage Bias\",xlab=\"\",yaxt=\"n\",xaxt=\"n\")\naxis(2,at=seq(-.30,.30,0.1),labels=paste(seq(-30,30,10),\"%\",sep=\"\"),las=2)\nabline(h=seq(-0.95,0.95,by=0.1),col=\"gray75\",lty=2)\nabline(h=seq(-1,1,by=0.1),col=\"gray70\")\nabline(h=0,col=\"black\",lwd=3)\naxis(1,at=seq(0,300000000,by=25000000),labels=NA)\naxis(1,at=seq(0,300000000,by=25000000),labels=paste(seq(0,300,25),\"Mb\",sep=\"\"),tick=F,line=-0.6)\nmtext(1,text=\"Coordinate (chr1; GRCh37)\",line=1.5)\napply(SFARIminus$res[,4:ncol(SFARIminus$res)],2,function(vals){\n  points(smooth.spline(SFARIminus$mat$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(\"red\",alpha=0.05))\n})\napply(SFARIplus$res[,4:ncol(SFARIplus$res)],2,function(vals){\n  points(smooth.spline(SFARIplus$mat$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(\"blue\",alpha=0.05))\n})\nlegend(\"topright\",legend=c(\"Batch 1\",\"Batch 2\"),lwd=2,col=c(\"blue\",\"red\"))\ndev.off()\n#Clear memory\nrm(SFARIplus,SFARIminus)\n\n#####Master plot of all libraries\n#Read Data\nSFARIplus <- WGD.matrix.tranche(WGD.matrix.read(paste(WRKDIR,\"../test/SFARIplus.1.normCov.10kb.matrix.bed.gz\",sep=\"\")),tranche=0.98)$res\nSFARIminus <- WGD.matrix.tranche(WGD.matrix.read(paste(WRKDIR,\"../test/SFARIminus.1.normCov.10kb.matrix.bed.gz\",sep=\"\")),tranche=0.98)$res\nNHLBI <- WGD.matrix.tranche(WGD.matrix.read(paste(WRKDIR,\"../test/NHLBI.1.normCov.10kb.matrix.bed.gz\",sep=\"\")),tranche=0.98)$res\nFINNS <- WGD.matrix.tranche(WGD.matrix.read(paste(WRKDIR,\"../test/Finns.1.normCov.10kb.matrix.bed.gz\",sep=\"\")),tranche=0.98)$res\nCMG <- WGD.matrix.tranche(WGD.matrix.read(paste(WRKDIR,\"../test/CMG.1.normCov.10kb.matrix.bed.gz\",sep=\"\")),tranche=0.98)$res\nAFIB <- WGD.matrix.tranche(WGD.matrix.read(paste(WRKDIR,\"../test/AFib.1.normCov.10kb.matrix.bed.gz\",sep=\"\")),tranche=0.98)$res\nliWGS <- WGD.matrix.tranche(WGD.matrix.read(paste(WRKDIR,\"../test/liWGS.1.normCov.10kb.matrix.bed.gz\",sep=\"\")),tranche=0.98)$res\n#Set color palette\npal <- c(\"firebrick3\",\"firebrick2\",\"firebrick1\",\"firebrick4\",\n         \"dodgerblue3\",\"dodgerblue2\",\"dodgerblue1\",\"dodgerblue4\")\n#Plot SFARI alone\ntiff(paste(WRKDIR,\"SFARI.setCol.chr1.tiff\"),width=1500,height=675,pointsize=18)\npar(mar=c(3.1,4.1,1.1,1.1))\nplot(c(0,max(SFARIplus$end)),c(-0.30,0.30),type=\"n\",xaxs=\"i\",yaxs=\"i\",\n     ylab=\"Normalized Coverage Bias\",xlab=\"\",yaxt=\"n\",xaxt=\"n\")\naxis(2,at=seq(-.30,.30,0.1),labels=paste(seq(-30,30,10),\"%\",sep=\"\"),las=2)\nabline(h=seq(-0.95,0.95,by=0.1),col=\"gray75\",lty=2)\nabline(h=seq(-1,1,by=0.1),col=\"gray70\")\nabline(h=0,col=\"black\",lwd=3)\naxis(1,at=seq(0,300000000,by=25000000),labels=NA)\naxis(1,at=seq(0,300000000,by=25000000),labels=paste(seq(0,300,25),\"Mb\",sep=\"\"),tick=F,line=-0.6)\nmtext(1,text=\"Coordinate (chr1; GRCh37)\",line=1.5)\napply(SFARIminus[,4:ncol(SFARIminus)],2,function(vals){\n  points(smooth.spline(SFARIminus$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[1],alpha=0.05))\n})\napply(SFARIplus[,4:ncol(SFARIplus)],2,function(vals){\n  points(smooth.spline(SFARIplus$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[5],alpha=0.05))\n})\nlegend(\"topright\",legend=c(\"PCR+\",\"PCR-\"),pch=19,cex=0.8,col=c(\"firebrick3\",\"dodgerblue3\"),bg=\"white\")\ndev.off()\n#Plot SFARI + FINNS\ntiff(paste(WRKDIR,\"SFARI_FINNS.setCol.chr1.tiff\"),width=1500,height=675,pointsize=18)\npar(mar=c(3.1,4.1,1.1,1.1))\nplot(c(0,max(SFARIplus$end)),c(-0.30,0.30),type=\"n\",xaxs=\"i\",yaxs=\"i\",\n     ylab=\"Normalized Coverage Bias\",xlab=\"\",yaxt=\"n\",xaxt=\"n\")\naxis(2,at=seq(-.30,.30,0.1),labels=paste(seq(-30,30,10),\"%\",sep=\"\"),las=2)\nabline(h=seq(-0.95,0.95,by=0.1),col=\"gray75\",lty=2)\nabline(h=seq(-1,1,by=0.1),col=\"gray70\")\nabline(h=0,col=\"black\",lwd=3)\naxis(1,at=seq(0,300000000,by=25000000),labels=NA)\naxis(1,at=seq(0,300000000,by=25000000),labels=paste(seq(0,300,25),\"Mb\",sep=\"\"),tick=F,line=-0.6)\nmtext(1,text=\"Coordinate (chr1; GRCh37)\",line=1.5)\napply(SFARIminus[,4:ncol(SFARIminus)],2,function(vals){\n  points(smooth.spline(SFARIminus$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[1],alpha=0.05))\n})\napply(SFARIplus[,4:ncol(SFARIplus)],2,function(vals){\n  points(smooth.spline(SFARIplus$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[5],alpha=0.05))\n})\napply(FINNS[,4:ncol(FINNS)],2,function(vals){\n  points(smooth.spline(FINNS$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[6],alpha=0.05))\n})\nlegend(\"topright\",legend=c(\"PCR+\",\"PCR-\"),pch=19,cex=0.8,col=c(\"firebrick3\",\"dodgerblue3\"),bg=\"white\")\ndev.off()\n#Plot SFARI + FINNS + NHLBI\ntiff(paste(WRKDIR,\"SFARI_FINNS_NHLBI.setCol.chr1.tiff\"),width=1500,height=675,pointsize=18)\npar(mar=c(3.1,4.1,1.1,1.1))\nplot(c(0,max(SFARIplus$end)),c(-0.30,0.30),type=\"n\",xaxs=\"i\",yaxs=\"i\",\n     ylab=\"Normalized Coverage Bias\",xlab=\"\",yaxt=\"n\",xaxt=\"n\")\naxis(2,at=seq(-.30,.30,0.1),labels=paste(seq(-30,30,10),\"%\",sep=\"\"),las=2)\nabline(h=seq(-0.95,0.95,by=0.1),col=\"gray75\",lty=2)\nabline(h=seq(-1,1,by=0.1),col=\"gray70\")\nabline(h=0,col=\"black\",lwd=3)\naxis(1,at=seq(0,300000000,by=25000000),labels=NA)\naxis(1,at=seq(0,300000000,by=25000000),labels=paste(seq(0,300,25),\"Mb\",sep=\"\"),tick=F,line=-0.6)\nmtext(1,text=\"Coordinate (chr1; GRCh37)\",line=1.5)\napply(SFARIminus[,4:ncol(SFARIminus)],2,function(vals){\n  points(smooth.spline(SFARIminus$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[1],alpha=0.05))\n})\napply(SFARIplus[,4:ncol(SFARIplus)],2,function(vals){\n  points(smooth.spline(SFARIplus$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[5],alpha=0.05))\n})\napply(FINNS[,4:ncol(FINNS)],2,function(vals){\n  points(smooth.spline(FINNS$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[6],alpha=0.05))\n})\napply(NHLBI[,4:ncol(NHLBI)],2,function(vals){\n  points(smooth.spline(NHLBI$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[2],alpha=0.05))\n})\nlegend(\"topright\",legend=c(\"PCR+\",\"PCR-\"),pch=19,cex=0.8,col=c(\"firebrick3\",\"dodgerblue3\"),bg=\"white\")\ndev.off()\n#Plot SFARI + FINNS + NHLBI + CMG + AFIB\ntiff(paste(WRKDIR,\"SFARI_FINNS_NHLBI_CMG_AFIB.setCol.chr1.tiff\"),width=1500,height=675,pointsize=18)\npar(mar=c(3.1,4.1,1.1,1.1))\nplot(c(0,max(SFARIplus$end)),c(-0.30,0.30),type=\"n\",xaxs=\"i\",yaxs=\"i\",\n     ylab=\"Normalized Coverage Bias\",xlab=\"\",yaxt=\"n\",xaxt=\"n\")\naxis(2,at=seq(-.30,.30,0.1),labels=paste(seq(-30,30,10),\"%\",sep=\"\"),las=2)\nabline(h=seq(-0.95,0.95,by=0.1),col=\"gray75\",lty=2)\nabline(h=seq(-1,1,by=0.1),col=\"gray70\")\nabline(h=0,col=\"black\",lwd=3)\naxis(1,at=seq(0,300000000,by=25000000),labels=NA)\naxis(1,at=seq(0,300000000,by=25000000),labels=paste(seq(0,300,25),\"Mb\",sep=\"\"),tick=F,line=-0.6)\nmtext(1,text=\"Coordinate (chr1; GRCh37)\",line=1.5)\napply(SFARIminus[,4:ncol(SFARIminus)],2,function(vals){\n  points(smooth.spline(SFARIminus$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[1],alpha=0.05))\n})\napply(SFARIplus[,4:ncol(SFARIplus)],2,function(vals){\n  points(smooth.spline(SFARIplus$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[5],alpha=0.05))\n})\napply(FINNS[,4:ncol(FINNS)],2,function(vals){\n  points(smooth.spline(FINNS$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[6],alpha=0.05))\n})\napply(NHLBI[,4:ncol(NHLBI)],2,function(vals){\n  points(smooth.spline(NHLBI$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[2],alpha=0.05))\n})\napply(CMG[,4:ncol(CMG)],2,function(vals){\n  points(smooth.spline(CMG$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[3],alpha=0.05))\n})\napply(AFIB[,4:ncol(AFIB)],2,function(vals){\n  points(smooth.spline(AFIB$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[3],alpha=0.05))\n})\nlegend(\"topright\",legend=c(\"PCR+\",\"PCR-\"),pch=19,cex=0.8,col=c(\"firebrick3\",\"dodgerblue3\"),bg=\"white\")\ndev.off()\n#Plot SFARI + FINNS + NHLBI+ CMG + AFIB + liWGS\ntiff(paste(WRKDIR,\"SFARI_FINNS_NHLBI_CMG_AFIB_liWGS.setCol.chr1.tiff\"),width=1500,height=675,pointsize=18)\npar(mar=c(3.1,4.1,1.1,1.1))\nplot(c(0,max(SFARIplus$end)),c(-0.30,0.30),type=\"n\",xaxs=\"i\",yaxs=\"i\",\n     ylab=\"Normalized Coverage Bias\",xlab=\"\",yaxt=\"n\",xaxt=\"n\")\naxis(2,at=seq(-.30,.30,0.1),labels=paste(seq(-30,30,10),\"%\",sep=\"\"),las=2)\nabline(h=seq(-0.95,0.95,by=0.1),col=\"gray75\",lty=2)\nabline(h=seq(-1,1,by=0.1),col=\"gray70\")\nabline(h=0,col=\"black\",lwd=3)\naxis(1,at=seq(0,300000000,by=25000000),labels=NA)\naxis(1,at=seq(0,300000000,by=25000000),labels=paste(seq(0,300,25),\"Mb\",sep=\"\"),tick=F,line=-0.6)\nmtext(1,text=\"Coordinate (chr1; GRCh37)\",line=1.5)\napply(SFARIminus[,4:ncol(SFARIminus)],2,function(vals){\n  points(smooth.spline(SFARIminus$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[1],alpha=0.05))\n})\napply(SFARIplus[,4:ncol(SFARIplus)],2,function(vals){\n  points(smooth.spline(SFARIplus$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[5],alpha=0.05))\n})\napply(FINNS[,4:ncol(FINNS)],2,function(vals){\n  points(smooth.spline(FINNS$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[6],alpha=0.05))\n})\napply(NHLBI[,4:ncol(NHLBI)],2,function(vals){\n  points(smooth.spline(NHLBI$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[2],alpha=0.05))\n})\napply(CMG[,4:ncol(CMG)],2,function(vals){\n  points(smooth.spline(CMG$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[3],alpha=0.05))\n})\napply(AFIB[,4:ncol(AFIB)],2,function(vals){\n  points(smooth.spline(AFIB$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[3],alpha=0.05))\n})\napply(liWGS[,4:ncol(liWGS)],2,function(vals){\n  points(smooth.spline(liWGS$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(pal[7],alpha=0.05))\n})\nlegend(\"topright\",legend=c(\"PCR+\",\"PCR-\"),pch=19,cex=0.8,col=c(\"firebrick3\",\"dodgerblue3\"),bg=\"white\")\ndev.off()\n# #Plot ALL -- colored by majority PCR status\n# tiff(paste(WRKDIR,\"ALL.PCR_Col.chr1.tiff\"),width=1500,height=675,pointsize=18)\n# par(mar=c(3.1,4.1,1.1,1.1))\n# plot(c(0,max(SFARIplus$end)),c(-0.30,0.30),type=\"n\",xaxs=\"i\",yaxs=\"i\",\n#      ylab=\"Normalized Coverage Bias\",xlab=\"\",yaxt=\"n\",xaxt=\"n\")\n# axis(2,at=seq(-.30,.30,0.1),labels=paste(seq(-30,30,10),\"%\",sep=\"\"),las=2)\n# abline(h=seq(-0.95,0.95,by=0.1),col=\"gray75\",lty=2)\n# abline(h=seq(-1,1,by=0.1),col=\"gray70\")\n# abline(h=0,col=\"black\",lwd=3)\n# axis(1,at=seq(0,300000000,by=25000000),labels=NA)\n# axis(1,at=seq(0,300000000,by=25000000),labels=paste(seq(0,300,25),\"Mb\",sep=\"\"),tick=F,line=-0.6)\n# mtext(1,text=\"Coordinate (chr1; GRCh37)\",line=1.5)\n# apply(SFARIplus[,4:ncol(SFARIplus)],2,function(vals){\n#   points(smooth.spline(SFARIplus$start,vals,spar=0.2),type=\"l\",\n#          col=adjustcolor(\"blue\",alpha=0.05))\n# })\n# apply(SFARIminus[,4:ncol(SFARIminus)],2,function(vals){\n#   points(smooth.spline(SFARIminus$start,vals,spar=0.2),type=\"l\",\n#          col=adjustcolor(\"red\",alpha=0.05))\n# })\n# apply(CMG[,4:ncol(CMG)],2,function(vals){\n#   points(smooth.spline(CMG$start,vals,spar=0.2),type=\"l\",\n#          col=adjustcolor(\"red\",alpha=0.05))\n# })\n# apply(AFIB[,4:ncol(AFIB)],2,function(vals){\n#   points(smooth.spline(AFIB$start,vals,spar=0.2),type=\"l\",\n#          col=adjustcolor(\"red\",alpha=0.05))\n# })\n# apply(liWGS[,4:ncol(liWGS)],2,function(vals){\n#   points(smooth.spline(liWGS$start,vals,spar=0.2),type=\"l\",\n#          col=adjustcolor(\"blue\",alpha=0.05))\n# })\n# apply(NHLBI[,4:ncol(NHLBI)],2,function(vals){\n#   points(smooth.spline(NHLBI$start,vals,spar=0.2),type=\"l\",\n#          col=adjustcolor(\"red\",alpha=0.05))\n# })\n# apply(FINNS[,4:ncol(FINNS)],2,function(vals){\n#   points(smooth.spline(FINNS$start,vals,spar=0.2),type=\"l\",\n#          col=adjustcolor(\"blue\",alpha=0.05))\n# })\n# legend(\"topright\",legend=c(\"PCR+\",\"PCR-\"),pch=19,cex=0.8,col=c(\"blue\",\"red\"),bg=\"white\")\n# dev.off()\n\n#####Prep for correlation analyses vs training set\n#Read training set statistics & annotation matrix\nTRAIN <- read.table(paste(WRKDIR,\"TRAINING_SET.WGD_scores.ALL_BINS_summary.bed.gz\",sep=\"\"),header=T)\nANNO <- read.table(paste(WRKDIR,\"all_annotations.10kb_matrix.bed.gz\",sep=\"\"),header=T,comment.char=\"\")\n#Merge training set stats with annotations\nTRAIN.ANNO <- merge(TRAIN,ANNO,sort=F,by=c(1:3))\n#Read N-masked regions\nNMASK <- read.table(paste(WRKDIR,\"GRCh37_Nmask.bed\",sep=\"\"),header=F)\n\n#####Plot training set means vs 10X libraries\nMcC_10X <- WGD.matrix.tranche(WGD.matrix.read(paste(WRKDIR,\"../test/McC_10X.1.normCov.10kb.matrix.bed.gz\",sep=\"\")),tranche=0.98)$res\ntiff(paste(WRKDIR,\"trainingSet_w10X.chr1.tiff\"),width=1500,height=675,pointsize=18)\npar(mar=c(3.1,4.1,1.1,1.1))\nplot(c(0,max(SFARIplus$end)),c(-0.30,0.30),type=\"n\",xaxs=\"i\",yaxs=\"i\",\n     ylab=\"Normalized Coverage Bias\",xlab=\"\",yaxt=\"n\",xaxt=\"n\")\naxis(2,at=seq(-.30,.30,0.1),labels=paste(seq(-30,30,10),\"%\",sep=\"\"),las=2)\nabline(h=seq(-0.95,0.95,by=0.1),col=\"gray75\",lty=2)\nabline(h=seq(-1,1,by=0.1),col=\"gray70\")\nabline(h=0,col=\"black\",lwd=3)\naxis(1,at=seq(0,300000000,by=25000000),labels=NA)\naxis(1,at=seq(0,300000000,by=25000000),labels=paste(seq(0,300,25),\"Mb\",sep=\"\"),tick=F,line=-0.6)\nmtext(1,text=\"Coordinate (chr1; GRCh37)\",line=1.5)\n# A.avg.upper <- smooth.spline(TRAIN$start[which(TRAIN$chr==1)],TRAIN$A.mean[which(TRAIN$chr==1)]+TRAIN$A.sd[which(TRAIN$chr==1)],spar=0.2)\nA.avg <- smooth.spline(TRAIN$start[which(TRAIN$chr==1)],TRAIN$A.mean[which(TRAIN$chr==1)],spar=0.2)\n# A.avg.lower <- smooth.spline(TRAIN$start[which(TRAIN$chr==1)],TRAIN$A.mean[which(TRAIN$chr==1)]-TRAIN$A.sd[which(TRAIN$chr==1)],spar=0.2)\n# B.avg.upper <- smooth.spline(TRAIN$start[which(TRAIN$chr==1)],TRAIN$B.mean[which(TRAIN$chr==1)]+TRAIN$B.sd[which(TRAIN$chr==1)],spar=0.2)\nB.avg <- smooth.spline(TRAIN$start[which(TRAIN$chr==1)],TRAIN$B.mean[which(TRAIN$chr==1)],spar=0.2)\n# B.avg.lower <- smooth.spline(TRAIN$start[which(TRAIN$chr==1)],TRAIN$B.mean[which(TRAIN$chr==1)]-TRAIN$B.sd[which(TRAIN$chr==1)],spar=0.2)\n# polygon(x=c(A.avg.upper$x,rev(A.avg.lower$x)),\n#         y=c(A.avg.upper$y,A.avg.lower$y),\n#         border=NA,col=adjustcolor(\"blue\",0.2))\n# polygon(x=c(B.avg.upper$x,rev(B.avg.lower$x)),\n#         y=c(B.avg.upper$y,B.avg.lower$y),\n#         border=NA,col=adjustcolor(\"red\",0.2))\npoints(A.avg$x,A.avg$y,col=\"blue\",lwd=5,type=\"l\")\npoints(B.avg$x,B.avg$y,col=\"red\",lwd=5,type=\"l\")\napply(McC_10X[,4:ncol(McC_10X)],2,function(vals){\n  points(smooth.spline(McC_10X$start,vals,spar=0.2),type=\"l\",\n         col=adjustcolor(\"cyan3\",alpha=0.3))\n})\nlegend(\"topleft\",col=c(\"blue\",\"red\",\"cyan3\"),lwd=5,\n       legend=c(\"PCR+ (mean)\",\"PCR- (mean)\",\"Chromium 10X\"),\n       bg=\"white\")\ndev.off()\n\n#Clean up data\nrm(SFARIplus,SFARIminus,NHLBI,CMG,AFIB,liWGS,FINNS,McC_10X)\n\n#####Plot of training set by contig\npdf(paste(WRKDIR,\"GRCh37.training_set_means.autosomes.pdf\",sep=\"\"),height=10,width=20)\npar(mfrow=c(4,6),mar=c(1.6,3.1,2.1,0.6))\nfor(contig in 1:18){\n  #subset fraction of data to be plotted\n  plotset <- TRAIN.ANNO[which(TRAIN.ANNO$chr==contig),1:8]\n  plot(x=c(0,max(plotset$start)),y=c(-0.20,0.20),type=\"n\",xaxs=\"i\",yaxs=\"i\",yaxt=\"n\",xaxt=\"n\",ylab=\"\",xlab=\"\")\n  axis(2,at=seq(-.20,.20,0.05),labels=NA)\n  axis(2,at=seq(-.20,.20,0.05),labels=paste(seq(-20,20,5),\"%\",sep=\"\"),las=2,line=-0.5,cex.axis=0.8,tick=F)\n  mtext(2,font=2,text=\"Average Coverage Bias\",line=1.75,cex=0.8)\n  abline(h=seq(-0.95,0.95,by=0.1),col=\"gray70\",lty=2)\n  abline(h=seq(-1,1,by=0.1),col=\"gray60\")\n  abline(v=seq(0,max(plotset$start),by=10000000),col=\"gray85\")\n  abline(h=0,col=\"black\",lwd=3)\n  axis(1,at=seq(0,max(plotset$start),by=30000000),labels=NA)\n  axis(1,at=seq(0,max(plotset$start),by=30000000),cex.axis=0.9,\n       labels=paste(seq(0,max(plotset$start)/1000000,30),\"M\",sep=\"\"),tick=F,line=-0.6)\n  title(paste(\"chr\",contig,sep=\"\"))\n  spline.A <- smooth.spline(plotset$start,plotset$A.mean,spar=0.5)\n  spline.B <- smooth.spline(plotset$start,plotset$B.mean,spar=0.5)\n  polygon(x=c(spline.A$x,rev(spline.A$x)),\n          y=c(spline.A$y,rep(0,times=length(spline.A$y))),\n          col=adjustcolor(\"blue\",alpha=0.3),border=NA)\n  polygon(x=c(spline.B$x,rev(spline.B$x)),\n          y=c(spline.B$y,rep(0,times=length(spline.B$y))),\n          col=adjustcolor(\"red\",alpha=0.3),border=NA)\n  points(spline.A,type=\"l\",col=\"blue\",lwd=3)\n  points(spline.B,type=\"l\",col=\"red\",lwd=3)\n  #Black out NMask regions >1Mb\n  plotmask <- NMASK[which(NMASK[,1]==contig & NMASK[,3]-NMASK[,2]>=1000000),]\n  rect(xleft=plotmask[,2],xright=plotmask[,3],ybottom=par(\"usr\")[3],ytop=par(\"usr\")[4],\n       col=\"gray90\",border=NA)\n  text(labels=rep(\"N\",nrow(plotmask)),\n       x=apply(plotmask[,2:3],1,mean),y=0,\n       col=\"gray70\",font=3)\n  abline(h=par(\"usr\")[3:4],lwd=2)\n}\npar(bty=\"n\")\nplot(x=0,y=0,type=\"n\",xaxt=\"n\",yaxt=\"n\",xlab=\"\",ylab=\"\")\npar(bty=\"o\")\nfor(contig in 19:22){\n  #subset fraction of data to be plotted\n  plotset <- TRAIN.ANNO[which(TRAIN.ANNO$chr==contig),1:8]\n  plot(x=c(0,max(plotset$start)),y=c(-0.20,0.20),type=\"n\",xaxs=\"i\",yaxs=\"i\",yaxt=\"n\",xaxt=\"n\",ylab=\"\",xlab=\"\")\n  axis(2,at=seq(-.20,.20,0.05),labels=NA)\n  axis(2,at=seq(-.20,.20,0.05),labels=paste(seq(-20,20,5),\"%\",sep=\"\"),las=2,line=-0.5,cex.axis=0.8,tick=F)\n  mtext(2,font=2,text=\"Average Coverage Bias\",line=1.75,cex=0.8)\n  abline(h=seq(-0.95,0.95,by=0.1),col=\"gray70\",lty=2)\n  abline(h=seq(-1,1,by=0.1),col=\"gray60\")\n  abline(v=seq(0,max(plotset$start),by=10000000),col=\"gray85\")\n  abline(h=0,col=\"black\",lwd=3)\n  axis(1,at=seq(0,max(plotset$start),by=30000000),labels=NA)\n  axis(1,at=seq(0,max(plotset$start),by=30000000),cex.axis=0.9,\n       labels=paste(seq(0,max(plotset$start)/1000000,30),\"M\",sep=\"\"),tick=F,line=-0.6)\n  title(paste(\"chr\",contig,sep=\"\"))\n  spline.A <- smooth.spline(plotset$start,plotset$A.mean,spar=0.5)\n  spline.B <- smooth.spline(plotset$start,plotset$B.mean,spar=0.5)\n  polygon(x=c(spline.A$x,rev(spline.A$x)),\n          y=c(spline.A$y,rep(0,times=length(spline.A$y))),\n          col=adjustcolor(\"blue\",alpha=0.3),border=NA)\n  polygon(x=c(spline.B$x,rev(spline.B$x)),\n          y=c(spline.B$y,rep(0,times=length(spline.B$y))),\n          col=adjustcolor(\"red\",alpha=0.3),border=NA)\n  points(spline.A,type=\"l\",col=\"blue\",lwd=3)\n  points(spline.B,type=\"l\",col=\"red\",lwd=3)\n  #Black out NMask regions >1Mb\n  plotmask <- NMASK[which(NMASK[,1]==contig & NMASK[,3]-NMASK[,2]>=1000000),]\n  rect(xleft=plotmask[,2],xright=plotmask[,3],ybottom=par(\"usr\")[3],ytop=par(\"usr\")[4],\n       col=\"gray90\",border=NA)\n  text(labels=rep(\"N\",nrow(plotmask)),\n       x=apply(plotmask[,2:3],1,mean),y=0,\n       col=\"gray70\",font=3)\n  abline(h=par(\"usr\")[3:4],lwd=2)\n}\ndev.off()\n\n#####Prep for multiple correlations between features and dAB\n#Setup\nif(!(dir.exists(paste(WRKDIR,\"correlations\",sep=\"\")))){\n  dir.create(paste(WRKDIR,\"correlations\",sep=\"\"))\n}\n#Palettes\npal <- colorRampPalette(c(\"red\",\"gray30\",\"blue\"))\npal.w <- colorRampPalette(c(\"red\",\"gray90\",\"blue\"))\n#Gather list of quintile statistics\nfeature.quints <- sapply(9:ncol(TRAIN.ANNO),function(i){\n  res <- as.data.frame(matrix(unlist(lapply(list(bB2,bB1,bN,bA1,bA2),function(vals){\n    response <- TRAIN.ANNO[vals,i]\n    m <- mean(response,na.rm=T)\n    stde <- 2*std.error(response,na.rm=T)\n    return(c(m,stde))\n  })),nrow=5,byrow=T))\n  colnames(res) <- c(\"mean\",\"CI\")\n  rownames(res) <- c(\"B2\",\"B1\",\"N\",\"A1\",\"A2\")\n  res$mean.ctr <- res$mean-res$mean[3]\n  res$mean.fold <- res$mean/res$mean[3]\n  res$mean.l2fold <- log2(res$mean/res$mean[3])\n  return(res)\n})\n#Assign modules\nm.gene <- c(1:4)+3\nm.seq_context <- c(5,16:23,33,35,37,43,44,46)+3\nm.txn_reg <- c(14:16,25:32,36,39,48,49)+3\nm.nuc_arc <- c(13,34,47,72)+3\nm.var <- c(45,50:52)+3\nm.associations <- c(12,38)+3\nm.disease <- c(6:11,40)+3\nm.tech <- c(41:42)+3\nm.ORDER <- c(m.gene,m.seq_context,m.txn_reg,m.nuc_arc,\n             m.var,m.associations,m.disease,m.tech)\nm.ORDER.list <- list(m.gene,m.seq_context,m.txn_reg,m.nuc_arc,\n                     m.var,m.associations,m.disease,m.tech)\nm.ORDER.breaks <- sapply(1:length(m.ORDER.list),function(i){\n  sum(unlist(lapply(m.ORDER.list[1:i],length)))\n})\n\n#####Master correlation matrix between features\n#Prep plot\npng(paste(WRKDIR,\"feature_correlation_heatmap.png\"),width=1000*(58/53),height=1000)\npar(mar=c(0.1,0.1,0.1,0.1))\nplot(x=c(0,length(m.ORDER)+5),y=c(0,length(m.ORDER)),\n     ylab=\"\",xlab=\"\",yaxs=\"i\",xaxs=\"i\",xaxt=\"n\",yaxt=\"n\",type=\"n\")\n#Plot heatmap\nsapply(1:length(m.ORDER),function(x){\n  sapply(1:length(m.ORDER),function(y){\n    #Calculate correlation & assign color\n    c <- cor(ANNO[,m.ORDER[x]],ANNO[,m.ORDER[y]],use=\"complete.obs\")\n    scaled.c <- 2*c\n    if(scaled.c > 1){\n      scaled.c <- 1\n    }else if(scaled.c < -1){\n      scaled.c <- -1\n    }\n    color <- pal.w(201)[ceiling(100*(scaled.c+1))]\n    #Plot rect\n    rect(xleft=x-1,xright=x,\n         ybottom=length(m.ORDER)-(y-1),\n         ytop=length(m.ORDER)-y,\n         col=color,border=\"white\")\n  })\n})\n#Box around modules\nsapply(1:(length(m.ORDER.breaks)),function(i){\n  bps <- c(0,m.ORDER.breaks)\n  abline(v=bps[c(i,i+1)],col=\"black\",\n         h=length(m.ORDER)-bps[c(i,i+1)])\n  rect(xleft=length(m.ORDER),xright=par(\"usr\")[2],\n       ybottom=par(\"usr\")[3],ytop=par(\"usr\")[4],\n       col=\"white\",border=NA)\n  rect(xleft=bps[i],xright=bps[i+1],\n       ytop=length(m.ORDER)-bps[i],ybottom=length(m.ORDER)-bps[i+1],\n       col=NA,border=\"black\",lwd=5)\n})\n#Add correlation vs dosage bias\nsapply(1:length(m.ORDER),function(i){\n  c <- cor(TRAIN.ANNO$dAB,TRAIN.ANNO[,m.ORDER[i]+5],use=\"complete.obs\")\n  scaled.c <- 2*c\n  if(scaled.c > 1){\n    scaled.c <- 1\n  }else if(scaled.c < -1){\n    scaled.c <- -1\n  }\n  color <- pal.w(201)[ceiling(100*(scaled.c+1))]\n  #Plot rect\n  rect(xleft=length(m.ORDER)+2,xright=par(\"usr\")[2],\n       ybottom=length(m.ORDER)-(i-1),\n       ytop=length(m.ORDER)-i,\n       col=color,border=\"white\")\n})\n#Box around modules for correlation vs dosage bias\nsapply(1:(length(m.ORDER.breaks)),function(i){\n  bps <- c(0,m.ORDER.breaks)\n  rect(xleft=length(m.ORDER)+2,xright=par(\"usr\")[2],\n       ytop=length(m.ORDER)-bps[i],ybottom=length(m.ORDER)-bps[i+1],\n       col=NA,border=\"black\",lwd=3)\n})\ndev.off()\n\n#####Barplots\n#Master function to generate barplots from feature.quints\nfeat.bars <- function(indexes,spacer,pad,legend=T,OUTFILE){\n  #Extract fold-changes and remove N bin\n  folds <- as.data.frame(feature.quints[5,indexes])[-3,]\n  #Prep plot\n  pdf(OUTFILE,height=4,width=pad+(0.5*length(indexes)))\n  par(mar=c(0.6,3.1,0.6,0.1))\n  #Plot\n  plot(x=c(0,length(indexes)+spacer*(length(indexes)-1)),\n       y=c(-log(4),log(4)),type=\"n\",\n       yaxs=\"i\",xlab=\"\",ylab=\"\",xaxt=\"n\",yaxt=\"n\")\n  abline(h=(log2(seq(2,4,by=0.2)-1)),col=\"gray80\",lty=2)\n  abline(h=log2(seq(2,4,by=0.4)-1),col=\"gray70\")\n  abline(h=-(log2(seq(2,4,by=0.2)-1)),col=\"gray80\",lty=2)\n  abline(h=-log2(seq(2,4,by=0.4)-1),col=\"gray70\")\n  abline(h=0,lwd=2)\n  sapply(1:ncol(folds),function(i){\n    rect(xleft=seq(0,0.75,by=0.25)+(i-1)+(spacer*(i-1)),\n         xright=seq(0.25,1,by=0.25)+(i-1)+(spacer*(i-1)),\n         ybottom=0,\n         ytop=folds[,i],\n         col=pal.w(151)[c(1,51,101,151)])\n  })\n  axis(2,at=c(rev(-(log2(seq(2,4,by=0.4)-1))),log2(seq(2.4,4,by=0.4)-1)),labels=NA)\n  axis(2,at=c(rev(-(log2(seq(2,4,by=0.4)-1))),log2(seq(2.4,4,by=0.4)-1)),tick=F,line=-.3,\n       labels=seq(-2,2,by=0.4),las=2,cex.axis=0.7)\n  mtext(2,text=\"log2-fold Enrichment\",line=1.8,font=2,cex=0.8)\n  if(legend==T){\n    legend(\"bottomright\",legend=c(\"Strong PCR+ Bias\",\"Weak PCR+ Bias\",\"Weak PCR- Bias\",\"Strong PCR- Bias\"),\n           fill=rev(pal.w(151)[c(1,51,101,151)]),bg=\"white\",cex=0.6)\n  }\n  dev.off()\n}\n#Broad panel of features - gc, recomb, LINEs, SINEs, LCRs, 100mer align, genes\nfeat.bars(c(5,43,18,19,23,35,1),1.2,3,T,paste(WRKDIR,\"core_features.barplot.pdf\",sep=\"\"))\n#Enhancer Signature - TF occupancy & DNAH1\nfeat.bars(c(14,36),0.5,1,F,paste(WRKDIR,\"enhancer_signature.barplot.pdf\",sep=\"\"))\n#Expression - Max expression, avg expression\nfeat.bars(c(49,48,39),0.6,1.5,F,paste(WRKDIR,\"expression.barplot.pdf\",sep=\"\"))\n#Activating chromatin barplots\nfeat.bars(25:31,0.5,3,T,paste(WRKDIR,\"activating_chromatin_marks.barplot.pdf\",sep=\"\"))\n#Hammer slide - pc genes, constrained genes, AD genes, essential genes, GWAS loci, COSMIC, exonic bases, CNV loci\nfeat.bars(c(2,7,8,6,38,40,4,37),0.8,3,T,paste(WRKDIR,\"WGD_implications.barplot.pdf\",sep=\"\"))\n###Custom compartment barplots\n#Set params\nindexes <- c(47,72)\nspacer <- 1\npad <- 2\nlegend <- T\nOUTFILE <- paste(WRKDIR,\"compartments.barplot.pdf\",sep=\"\")\n#Extract relative means, subtract N mean, and remove N bin\nmeans <- as.data.frame(feature.quints[1,indexes])\nmeans <- apply(means,2,function(vals){\n  return(vals-vals[3])\n})\nmeans[,1] <- 4*means[,1]\nsds <- as.data.frame(feature.quints[2,indexes])\nsds[,1] <- 4*sds[,1]\nmeans <- means[-3,]\nsds <- sds[-3,]\n#Prep plot\npdf(OUTFILE,height=4,width=pad+(0.5*length(indexes)))\npar(mar=c(0.6,3.1,0.6,0.1))\n#Plot\nplot(x=c(0,length(indexes)+spacer*(length(indexes)-1)),\n     y=c(-5.5,5.5),type=\"n\",\n     yaxs=\"i\",xlab=\"\",ylab=\"\",xaxt=\"n\",yaxt=\"n\")\nabline(h=-5:5,col=\"gray70\",lwd=0.5)\nabline(h=0,lwd=2)\nsapply(1:ncol(means),function(i){\n  rect(xleft=seq(0,0.75,by=0.25)+(i-1)+(spacer*(i-1)),\n       xright=seq(0.25,1,by=0.25)+(i-1)+(spacer*(i-1)),\n       ybottom=0,\n       ytop=means[,i],\n       col=pal.w(151)[c(1,51,101,151)])\n  segments(x0=c(seq(0.125,0.875,0.25)+(i-1)+(spacer*(i-1))-0.05,\n                seq(0.125,0.875,0.25)+(i-1)+(spacer*(i-1))-0.05,\n                seq(0.125,0.875,0.25)+(i-1)+(spacer*(i-1))),\n           x1=c(seq(0.125,0.875,0.25)+(i-1)+(spacer*(i-1))+0.05,\n                seq(0.125,0.875,0.25)+(i-1)+(spacer*(i-1))+0.05,\n                seq(0.125,0.875,0.25)+(i-1)+(spacer*(i-1))),\n           y0=c(means[,i]-sds[,i],\n                means[,i]+sds[,i],\n                means[,i]-sds[,i]),\n           y1=c(means[,i]-sds[,i],\n                means[,i]+sds[,i],\n                means[,i]+sds[,i]))\n})\naxis(2,at=c(-5,-2.5,0,2.5,5),tick=F,line=-0.8,las=2)\nmtext(2,text=\"Compartment Usage\",line=1.8,font=2)\nif(legend==T){\n  legend(\"bottomright\",legend=c(\"Strong PCR+ Bias\",\"Weak PCR+ Bias\",\"Weak PCR- Bias\",\"Strong PCR- Bias\"),\n         fill=rev(pal.w(151)[c(1,51,101,151)]),bg=\"white\",cex=0.6)\n}\ndev.off()\n\n#Scatterplot correlations for rep timing, phylop, and GC\ncorscatter <- function(i,OUTFILE){\n  png(OUTFILE,height=600,width=600)\n  par(mar=c(0.1,0.1,0.1,0.1))\n  plot(TRAIN.ANNO$dAB,TRAIN.ANNO[,i],cex=0.3,pch=19,\n       col=adjustcolor(pal(201)[ceiling(100*(TRAIN.ANNO$dAB+1))],alpha=0.1),\n       xaxs=\"i\",yaxs=\"i\",xlab=\"\",ylab=\"\",xaxt=\"n\",yaxt=\"n\",\n       xlim=c(-1,1),ylim=quantile(TRAIN.ANNO[,i],c(0.025,0.975),na.rm=T))\n  abline(lm(TRAIN.ANNO[,i]~TRAIN.ANNO$dAB),col=\"cyan\",lwd=5)\n  dev.off()\n}\n#Rep timing\ncorscatter(54,paste(WRKDIR,\"rep_timing.scatter.png\",sep=\"\"))\n#PhyloP\ncorscatter(52,paste(WRKDIR,\"PhyloP.scatter.png\",sep=\"\"))\n#GC\ncorscatter(13,paste(WRKDIR,\"GC.scatter.png\",sep=\"\"))\n#GC\ncorscatter(10,paste(WRKDIR,\"pcGenes.scatter.png\",sep=\"\"))\n#LCL Compartment\ncorscatter(80,paste(WRKDIR,\"LCL_compartment.scatter.png\",sep=\"\"))\ncorscatter(77,paste(WRKDIR,\"Fibro_compartment.scatter.png\",sep=\"\"))\n\n\n#Run\nsapply(9:ncol(TRAIN.ANNO),function(i){\n  #Create directory for each feature\n  if(!(dir.exists(paste(WRKDIR,\"correlations/\",names(TRAIN.ANNO)[i],sep=\"\")))){\n    dir.create(paste(WRKDIR,\"correlations/\",names(TRAIN.ANNO)[i],sep=\"\"))\n  }\n  #dAB\n\n  # #meanA\n  # png(paste(WRKDIR,\"correlations/\",names(TRAIN.ANNO)[i],\"/\",\n  #           names(TRAIN.ANNO)[i],\".meanA.png\",sep=\"\"),\n  #     height=600,width=600)\n  # plot(TRAIN.ANNO$A.mean,TRAIN.ANNO[,i],cex=0.5,lwd=1.5,\n  #      col=adjustcolor(pal(201)[ceiling(100*(TRAIN.ANNO$A.mean+1))],alpha=0.1),\n  #      xlab=\"dAB\",ylab=names(TRAIN.ANNO)[i],xaxs=\"i\",yaxs=\"i\",\n  #      xlim=c(-1,1),ylim=quantile(TRAIN.ANNO[,i],c(0.025,0.975),na.rm=T))\n  # dev.off()\n  # #meanB\n  # png(paste(WRKDIR,\"correlations/\",names(TRAIN.ANNO)[i],\"/\",\n  #           names(TRAIN.ANNO)[i],\".meanB.png\",sep=\"\"),\n  #     height=600,width=600)\n  # plot(TRAIN.ANNO$B.mean,TRAIN.ANNO[,i],cex=0.5,lwd=1.5,\n  #      col=adjustcolor(pal(201)[ceiling(100*(TRAIN.ANNO$B.mean+1))],alpha=0.1),\n  #      xlab=\"dAB\",ylab=names(TRAIN.ANNO)[i],xaxs=\"i\",yaxs=\"i\",\n  #      xlim=c(-1,1),ylim=quantile(TRAIN.ANNO[,i],c(0.025,0.975),na.rm=T))\n  # dev.off()\n\n  #Split by dAB quintiles and scale to middle 20%\n  bA2 <- which(TRAIN.ANNO$dAB>0.6)\n  bA1 <- which(TRAIN.ANNO$dAB<=0.6 & TRAIN.ANNO$dAB>0.2)\n  bN <- which(TRAIN.ANNO$dAB<=0.2 & TRAIN.ANNO$dAB> -0.2)\n  bB1 <- which(TRAIN.ANNO$dAB<= -0.2 & TRAIN.ANNO$dAB> -0.6)\n  bB2 <- which(TRAIN.ANNO$dAB<= -0.6)\n  #Get stats by grouping\n  plotdata <- as.data.frame(matrix(unlist(lapply(list(bB2,bB1,bN,bA1,bA2),function(vals){\n    response <- TRAIN.ANNO[vals,i]\n    m <- mean(response,na.rm=T)\n    stde <- 2*std.error(response,na.rm=T)\n    return(c(m,stde))\n  })),nrow=5,byrow=T))\n  #Barplot\n  png(paste(WRKDIR,\"correlations/\",names(TRAIN.ANNO)[i],\"/\",\n            names(TRAIN.ANNO)[i],\".dAB.barplot.png\",sep=\"\"),\n      height=600,width=400)\n  plot(x=c(0,3),y=1.1*c(min(c(min(apply(plotdata,1,sum))),0),\n                    1.1*max(apply(plotdata,1,sum))),type=\"n\",\n       xaxs=\"i\",yaxs=\"i\")\n  abline(h=0)\n  rect(xleft=c(0.5:2.5)-0.3,xright=c(0.5:2.5)+0.3,\n       ybottom=rep(0,3),ytop=plotdata[,1],\n       col=c(\"red\",\"gray40\",\"blue\"))\n  segments(x0=c(c(0.5:2.5)-0.1,\n                c(0.5:2.5)-0.1,\n                0.5:2.5),\n           x1=c(c(0.5:2.5)+0.1,\n                c(0.5:2.5)+0.1,\n                0.5:2.5),\n           y0=c(plotdata[,1]-plotdata[,2],\n                plotdata[,1]+plotdata[,2],\n                plotdata[,1]-plotdata[,2]),\n           y1=c(plotdata[,1]-plotdata[,2],\n                plotdata[,1]+plotdata[,2],\n                plotdata[,1]+plotdata[,2]),\n           lwd=2)\n  dev.off()\n})\n\n\n\n\n\n",
    "created" : 1489458959345.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3195917946",
    "id" : "759B1C14",
    "lastKnownWriteTime" : 1480580659,
    "last_content_update" : 1480580659,
    "path" : "~/Desktop/RCollins/Talkowski_Local/NGS/Methods/WGS_Dosage_Anomalies/WGDosage_Analysis_Fall2016/MPG_plots/Dosage_MPG_analysis_code.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled4"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}